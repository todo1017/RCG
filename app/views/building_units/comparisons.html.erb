<p id="notice"><%= notice %></p>

<br>

<div class="scroll-table-div">

  <table class="scroll-table">
    <thead>
    <tr>
      <th>Number</th>
      <th>Floor</th>
      <th>Beds</th>
      <th>Baths</th>
      <th>Sq feet</th>
      <th>Market rent</th>
      <%- last_comp_group = "" %>
      <%- CompGroup.all.each do |comp_group| %>
        <%- Geography.all.each do |geography| %>
            <th>
                <%= comp_group.name if comp_group.name != last_comp_group %>
                <br>
                <%= geography.name %>
            </th>
            <% last_comp_group = comp_group.name %>
        <% end %>
      <% end %>
    </tr>
    </thead>

    <tbody>
    <% @building_units.each do |building_unit| %>
        <tr>
          <td><%= link_to building_unit.number, edit_building_unit_path(building_unit) %></td>
          <td><%= building_unit.floor %></td>
          <td><%= building_unit.beds %></td>
          <td><%= building_unit.baths %></td>
          <td><%= building_unit.sq_feet %></td>
          <td><%= building_unit.market_rent %></td>
            <%- CompGroup.all.each do |comp_group| %>
              <%- Geography.all.each do |geography| %>
                <td>
                    <% comps_1 = comps_query_1(building_unit, comp_group.id, geography.id) %>
                    <% comps_2 = comps_query_2(building_unit, comp_group.id, geography.id) %>
                    <% comps_1.each do |comp| %>
                        <%= render partial: "mouseover", locals: {comp: comp} %><br>
                    <% end.empty? and begin %>
                        nothing exact
                    <% end %>
                    <% comps_2.each do |comp| %>
                      <%= render partial: "mouseover", locals: {comp: comp} %><br>
                    <% end %>
                </td>
              <% end %>
            <% end %>
        </tr>
    <% end %>
    </tbody>
  </table>

</div>

<br>
<br>

